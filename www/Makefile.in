########################################################################

# This file is part of the UNAM RATIR/RATTEL software.

########################################################################

# Copyright Â© 2011, 2012, 2017, 2018, 2019 Alan M. Watson <alan@astro.unam.mx>
#
# Permission to use, copy, modify, and distribute this software for any
# purpose with or without fee is hereby granted, provided that the above
# copyright notice and this permission notice appear in all copies.
#
# THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
# WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED
# WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
# AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
# DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
# PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
# TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
# PERFORMANCE OF THIS SOFTWARE.

########################################################################

prefix						:=	@prefix@
SITE						:=	@SITE@

########################################################################

all						:	all-$(SITE)

install						:	all install-$(SITE)

########################################################################

.SUFFIXES:  .md .html
.md.html			:
	./make-html "$*".md >"$*".html
	
########################################################################

all-coatli				            :   \
    docs-coatli/index.html		        \
	docs-coatli/documentation.html
docs-oan-coatli/index.html  		:	docs-coatli/index.md
docs-oan-coatli/documentation.html	:	docs-coatli/documentation.md

install-coatli			:	install-linux

clean-coatli			:
	-rm -f docs-coatli/*.html
	
########################################################################

all-ddotioan-services				:	docs-ddotioan-services/index.html		\
							docs-ddotioan-services/documentation.html
docs-ddotioan-services/index.html		:	docs-ddotioan-services/index.md
docs-ddotioan-services/documentation.html	:	docs-ddotioan-services/documentation.md

install-ddotioan-services			:	install-linux

clean-ddotioan-services				:
	-rm -f docs-ddotioan-services/*.html
	
########################################################################

all-colibricu-services				:	docs-colibricu-services/index.html		\
							docs-colibricu-services/documentation.html
docs-colibricu-services/index.html		:	docs-colibricu-services/index.md
docs-colibricu-services/documentation.html	:	docs-colibricu-services/documentation.md

install-colibricu-services			:	install-linux

clean-colibricu-services				:
	-rm -f docs-colibricu-services/*.html
	
########################################################################

all-colibriohp-services				:	docs-colibriohp-services/index.html		\
							docs-colibriohp-services/documentation.html
docs-colibriohp-services/index.html		:	docs-colibriohp-services/index.md
docs-colibriohp-services/documentation.html	:	docs-colibriohp-services/documentation.md

install-colibriohp-services			:	install-linux

clean-colibriohp-services				:
	-rm -f docs-colibriohp-services/*.html
	
########################################################################

all-test					:	docs-test/index.html
docs-test/index.html				:	docs-test/index.md

install-test					:	install-linux

clean-test				:
	-rm -f docs-test/*.html
	
########################################################################

all-coatlicu-control				    	:	docs-coatlicu-control/index.html
docs-coatlicu-control/index.html			:	docs-coatlicu-control/index.md

install-coatlicu-control					:	install-linux

clean-coatlicu-control				        :
	-rm -f docs-coatlicu-control/*.html
	
########################################################################

install-macos					:
	sudo mkdir -p $(prefix)/var/www/
	sudo cp -r style.css docs-@SITE@/. $(prefix)/var/www/
	sudo cp httpd.conf-@SITE@ /etc/apache2/httpd.conf
	sudo apachectl restart

########################################################################

install-linux					:
	sudo mkdir -p $(prefix)/var/www/
	sudo cp -r style.css docs-@SITE@/. $(prefix)/var/www/.
	sudo rm -f /etc/apache2/sites-enabled/*
	sudo cp httpd.conf-@SITE@ /etc/apache2/sites-enabled/httpd.conf
	sudo a2enmod xml2enc proxy proxy_http proxy_html headers cgi
	sudo service apache2 restart
	sudo chmod -R go+w $(prefix)/var/www/
	sudo chown -R www-data:www-data $(prefix)/var/www/

########################################################################

clean						:	clean-@SITE@

distclean					:
	-rm -rf configure autom4te.cache config.log config.status
	-rm -rf Makefile
