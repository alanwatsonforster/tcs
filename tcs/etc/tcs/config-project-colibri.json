////////////////////////////////////////////////////////////////////////

// This file is part of the UNAM telescope control system.

////////////////////////////////////////////////////////////////////////

// Copyright © 2017, 2018, 2019 Alan M. Watson <alan@astro.unam.mx>
/
// Permission to use, copy, modify, and distribute this software for any
// purpose with or without fee is hereby granted, provided that the above
// copyright notice and this permission notice appear in all copies.
/
// THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
// WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED
// WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
// AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
// DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
// PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
// TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
// PERFORMANCE OF THIS SOFTWARE.

////////////////////////////////////////////////////////////////////////


{
  "C0": {
    "telescopedescription": "OAN COLIBRI 1.3-m",
    "detectortype": "fli",
    "detectoridentifier": "ML0032515",
    "detectorunbinnedpixelscale": "0.381as",
    "detectorreadmodes": {
      "initial": "default",
      "closed" : "default",
      "default": "8MHz"
    },
    "detectorinitialsoftwaregain": 1,
    "detectorinitialbinning": 1,
    "detectorwindows": {
      "initial": "full"
    },
    "detectorfullunbinneddatawindow": {
      "sx": 36,
      "sy": 22,
      "nx": 4096,
      "ny": 4096
    },
    "detectorfullunbinnedbiaswindow": {
      "sx": 0,
      "sy": 22,
      "nx": 4096,
      "ny": 11      
    },
    "coolerstartsetting": "following",
    "cooleropensetting": "0",
    "coolerclosedsetting": "following",
    "temperaturelimit": 50,
    "temperaturelimitoutletgroup": "",
    "filterwheelidentifier": "null",
    "filterwheeltype": "null",
    "filters": {
      "w"      : "0",
      "initial": "w",
      "idle"   : "w",
      "closed" : "w"
    },
    "focusertype": "null",
    "focuseridentifier": "null",
    "focuserinitialposition": 0,
    "focuserbacklashoffset": 0,
    "focuserdzmodel": {},
    "pointingmodelparameters": {},
    "isstandalone": false,
    "fitsfwhmargs": {
      "1": "",
      "2": "-A",
      "4": "-A",
      "8": "-A",
      "16": "-A"
    }
  },

  "covers": {
    "type": "opentsi",
    "port2name": "right",
    "port3name": "left"
  },
  "executor": {
    "type": "colibri"
  },
  "fitsheader": {
    "servers": [
      "target",
      "moon",
      "sun",
      "sensors",
      "weather"
    ]
  },
  "html": {
    "servers": [
      "instrument",
      "moon",
      "selector",
      "sensors",
      "supervisor",
      "sun",
      "target",
      "telescope",
      "weather"
    ]
  },
  "instrument": {
    "detectors": [
      "C0"
    ],
    "activedetectors": [
      "C0"
    ],
    "activefocusers": [
    ],
    "idlefilterwheelpositions": [
      "0"
    ],
    "pointingdetectors": [
      "C0"
    ],
    "outletgroups": []
  },
  "mount": {
    "type": "opentsi",
    "configuration": "azimuth-zenithdistance",
    // The parked derotator offset is with respect to the instrument structure.
    "derotatoroffsetpark": "-5d.00",
    // The unparked derotator offset is with respect to the cardinal directions of the detector.
    "derotatoroffsetunpark": "7.75d",
    // When the PLC parks the telescope, it uses these positions. These are not
    // configuarable using OpenTSI.
    // "azimuthpark": "-0.0025d",
    // "zenithdistancepark": "0.0036d",
    // "derotatoranglepark": "0d",
    // François recommends this position to place DDRAGUITO further from the enclosure entrance.
    "azimuthpark": "165d",
    "zenithdistancepark": "0.25d",
    "derotatoranglepark": "0d",
    // Unpark to the north.
    "haunpark": "0h",
    "deltaunpark": "75d",
    "minzenithdistancelimit": "0.5d",
    "maxzenithdistancelimit": "80d"
  },
  "plc": {
    "type": "colibri",
    "controllerhost": "192.168.100.28",
    "controllerport": "200"
  },
  "power": {
    "hosts": {
      "pdu1": {
        "type": "ibootpdu",
        "outlets": "8",
        "inlets": "1"
      },
      "pdu2": {
        "type": "ibootpdu",
        "outlets": "8",
        "inlets": "1"
      }
    },
    "outletgroupaddresses": {
      "access"              : [[ "pdu1", "a", "1"]],
      "firewall"            : [[ "pdu1", "a", "2"]],
      "blue"                : [[ "pdu1", "a", "3"]],
      "detectors"           : [[ "pdu1", "a", "4"]],
      "close-electronics"   : [[ "pdu1", "a", "5"]],
      "red"                 : [[ "pdu1", "a", "6"]],
      "control"             : [[ "pdu1", "a", "8"]],
      "blue-service-cabinet": [[ "pdu2", "a", "1"]],
      "red-service-cabinet" : [[ "pdu2", "a", "2"]]
    }
  },
  "safetyswitch": {
    "type": "none"
  },
  "secondary": {
    "type": "opentsi",
    "initialz0": "22750",
    "minz": "0",
    "maxz": "40000",
    "allowedzerror": "2",
    "zdeadzonewidth": "2",
    "dztweak": "-1000",
    "temperaturesensor": "telescope-M1-temperature",
    "dzmodel": {
      "filter": {}
    }
  },
  "selector": {},
  "sensors": {
    "lognames": [
      "host-control-load",
      "host-control-disk-space-used",
      "C0-detector-detector-temperature",
      "C0-detector-cooler-set-temperature",
      "C0-detector-cooler-state",
      "C0-filter-wheel-position"
    ],
    "sensors": {
      "host-control-load": {
        "file": "/usr/local/var/tcs/sensors/control/load",
        "keyword": "",
        "prettyname": "load on host control",
        "subsystem": "control-system",
        "component": "host-control",
        "group": "host-control",
        "type": "float",
        "unit": "processes",
        "model": "",
        "identifier": "",
        "firmware": ""
      },
      "host-control-disk-space-used": {
        "file": "/usr/local/var/tcs/sensors/control/disk-space-used",
        "keyword": "",
        "prettyname": "relative disk space used on host control",
        "subsystem": "control-system",
        "component": "host-control",
        "group": "host-control",
        "type": "float",
        "unit": "",
        "model": "",
        "identifier": "",
        "firmware": ""
      },
      "C0-detector-detector-temperature": {
        "file": "/usr/local/var/tcs/sensors/control/C0-detector-detector-temperature",
        "keyword": "",
        "prettyname": "C0 detector temperature",
        "subsystem": "ddraguito",
        "component": "C0-detector",
        "group": "detector-C0",
        "type": "float",
        "unit": "C",
        "model": "SI 1100",
        "identifier": "167",
        "firmware": ""
      },
      "C0-detector-cooler-set-temperature": {
        "file": "/usr/local/var/tcs/sensors/control/C0-detector-cooler-set-temperature",
        "keyword": "",
        "prettyname": "C0 cooler set temperature",
        "subsystem": "ddraguito",
        "component": "C0-detector",
        "group": "detector-C0",
        "type": "float",
        "unit": "C",
        "model": "SI 1100",
        "identifier": "167",
        "firmware": ""
      },
      "C0-detector-cooler-state": {
        "file": "/usr/local/var/tcs/sensors/control/C0-detector-cooler-state",
        "keyword": "",
        "prettyname": "C0 cooler state",
        "subsystem": "ddraguito",
        "component": "C0-detector",
        "group": "detector-C0",
        "type": "string",
        "unit": "state",
        "model": "SI 1100",
        "identifier": "167",
        "firmware": ""
      },
      "C0-filter-wheel-position": {
        "file": "/usr/local/var/tcs/sensors/control/C0-filter-wheel-position",
        "keyword": "",
        "prettyname": "C0 filter wheel position",
        "subsystem": "ddraguito",
        "component": "C0-detector",
        "group": "detector-C0",
        "type": "integer",
        "unit": "",
        "model": "FLI CFW-14-5",
        "identifier": "FW0021318",
        "firmware": ""
      },
      "weather-temperature": {
        "file": "/usr/local/var/tcs/sensors/control/weather-temperature",
        "prettyname": "temperature",
        "group": "environmental-sensors",
        "subsystem": "weather",
        "component": "vaisala",
        "type": "float",
        "unit": "C",
        "model": "",
        "identifier": "",
        "firmware": ""
      },
      "weather-humidity": {
        "file": "/usr/local/var/tcs/sensors/control/weather-humidity",
        "prettyname": "humidity",
        "group": "environmental-sensors",
        "subsystem": "weather",
        "component": "vaisala",
        "type": "float",
        "unit": "",
        "model": "",
        "identifier": "",
        "firmware": ""
      },
      "weather-dewpoint": {
        "file": "/usr/local/var/tcs/sensors/control/weather-dewpoint",
        "prettyname": "dewpoint",
        "group": "environmental-sensors",
        "subsystem": "weather",
        "component": "boltwood",
        "type": "float",
        "unit": "C",
        "model": "",
        "identifier": "",
        "firmware": ""
      },
      "weather-dewpoint-depression": {
        "file": "/usr/local/var/tcs/sensors/control/weather-dewpoint-depression",
        "prettyname": "dewpoint depression",
        "group": "environmental-sensors",
        "subsystem": "weather",
        "component": "boltwood",
        "type": "float",
        "unit": "C",
        "model": "",
        "identifier": "",
        "firmware": ""
      },
      "weather-wind-average-speed": {
        "file": "/usr/local/var/tcs/sensors/control/weather-wind-average-speed",
        "prettyname": "wind average speed",
        "group": "environmental-sensors",
        "subsystem": "weather",
        "component": "vaisala",
        "type": "float",
        "unit": "km/h",
        "model": "",
        "identifier": "",
        "firmware": ""
      },
      "weather-wind-gust-speed": {
        "file": "/usr/local/var/tcs/sensors/control/weather-wind-gust-speed",
        "prettyname": "wind gust speed",
        "group": "environmental-sensors",
        "subsystem": "weather",
        "component": "vaisala",
        "type": "float",
        "unit": "km/h",
        "model": "",
        "identifier": "",
        "firmware": ""
      },
      "weather-wind-average-azimuth": {
        "file": "/usr/local/var/tcs/sensors/control/weather-wind-average-azimuth",
        "prettyname": "wind average azimuth",
        "group": "environmental-sensors",
        "subsystem": "weather",
        "component": "vaisala",
        "type": "float",
        "unit": "deg",
        "model": "",
        "identifier": "",
        "firmware": ""
      },
      "weather-rain-rate": {
        "file": "/usr/local/var/tcs/sensors/control/weather-rain-rate",
        "prettyname": "rain rate",
        "group": "environmental-sensors",
        "subsystem": "weather",
        "component": "vaisala",
        "type": "float",
        "unit": "mm/h",
        "model": "",
        "identifier": "",
        "firmware": ""
      },
      "weather-pressure": {
        "file": "/usr/local/var/tcs/sensors/control/weather-pressure",
        "prettyname": "pressure",
        "group": "environmental-sensors",
        "subsystem": "weather",
        "component": "vaisala",
        "type": "float",
        "unit": "mbar",
        "model": "",
        "identifier": "",
        "firmware": ""
      },
      "dome-temperature": {
        "file": "/usr/local/var/tcs/sensors/control/ow/26.A493A0000000/temperature",
        "prettyname": "dome temperature",
        "subsystem": "telescope",
        "component": "dome",
        "group": "environmental-sensors",
        "type": "float",
        "unit": "C",
        "correctionmodel": "",
        "model": "iButtonLink MS-TH",
        "identifier": "26.A493A0000000",
        "firmware": ""
      },      
      "dome-humidity": {
        "file": "/usr/local/var/tcs/sensors/control/ow/26.A493A0000000/HIH4000/humidity",
        "prettyname": "dome humidity",
        "subsystem": "telescope",
        "component": "dome",
        "group": "environmental-sensors",
        "type": "float",
        "unit": "",
        "correctionmodel": "MS-H:1.0:0.0:0:0.0:0.0",
        "model": "iButtonLink MS-TH",
        "identifier": "26.A493A0000000",
        "firmware": ""
      },
      "dome-light-level": {
        "file": "/usr/local/var/tcs/sensors/control/ow/26.B5A940010000/VAD",
        "prettyname": "dome light level",
        "subsystem": "telescope",
        "component": "dome",
        "group": "environmental-sensors",
        "type": "float",
        "unit": "",
        "model": "iButtonLink MS-TL",
        "identifier": "26.B5A940010000",
        "firmware": ""
      }
    }
  },
  "site": {
    "longitude": "+115.46472d",
    "latitude": "+31.044722d",
    "altitude": "2800.0",
    "civiltimezone": "America/Tijuana"
  },
  "supervisor": {
    "withplc": "false",
    "internalhumiditysensor": "dome-humidity",
    "openoffsetseconds": "0",
    "opentoventilateoffsetseconds": "1800"
  },
  "swift": {
    "pointingsource": "none"
  },
  "target": {
    // Although the telescope can't track fast enough close to the zenith, it
    // has no formal limit. It does have a soft limit on zenith distance and
    // this configured to be 85d as of 2022-11-22
    // (TELESCOPE.CONFIG.POINTING.HORIZON_LIMIT).
    "minzenithdistancelimit": "1d",
    "maxzenithdistancelimit": "75d",
    "idleha": "0h",
    "idledelta": "75d"
  },
  "telescope": {
    "type": "dummy",
    "idleha": "0h",
    "idledelta": "0d"
  },
  "real-telescope": {
    "type": "colibri",
    "idleha": "0h",
    "idledelta": "0d"
  },
  "telescopecontroller": {
    "type": "opentsi"
  },
  "weather": {
    "windaveragespeedlimit": "30"
  }
}
