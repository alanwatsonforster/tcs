proposal::setidentifier "2017A-1000";
visit::setidentifier "0"
block::setidentifier 0
visit::setname "GRB 180210A"
block::settotalexposures 0
visit::setalertexposures "default"
visit::setalerttargetcoordinates fermilat 1.80d 18.35d 2000 0.18d
visit::setalerttimestamp "2018-02-10T12:24:38.55"
visit::setalertenabled true

proc SELECTABLE {args} {
  return [expr {
    [withintelescopepointinglimits] && 
    [maxskybrightness "nauticaltwilight"] &&
    [maxfocusdelay 1200] &&
    [minmoonseparation "15d"]
  }]
}

proc EXECUTE {args} {

  set exposuretime       30
  set exposuresperdither 2
  set filters            "w"
  
  executor::setsecondaryoffset 0
  executor::track

  executor::setreadmode 1MHz
  executor::setwindow "default"
  executor::setbinning 2

  executor::waituntiltracking

  foreach {alphaoffset deltaoffset} {
    -5am +7am
    -5am  0am
    -5am -7am
    -0am +7am
    -0am  0am
    -0am -7am
    +5am +7am
    +5am  0am
    +5am -7am
  } {

    executor::offset $alphaoffset $deltaoffset "default"
    executor::waituntiltracking

    foreach filter $filters {
      movefilterwheel $filter
      set i 0
      while {$i < $exposuresperdither} {
        executor::expose object $exposuretime
        incr i
      }
    }

  }

  return false
}
