proposal::setidentifier "2019B-1000"
block::setidentifier "1"
visit::setidentifier "0"
visit::setname "GRB 190929A"
block::settotalexposures 1
visit::settargetcoordinates equatorial 02:58:10.15 -08:57:27.4 2000

proc SELECTABLE {args} {
  return [expr {
    [withintelescopepointinglimits] && 
    [maxskybrightness "astronomicaltwilight"] &&
    [minmoonseparation "15d"] &&
    [maxairmass 2.0] &&
    [maxfocusdelay 1200]
  }]
}

proc EXECUTE {args} {

  set exposuretime       30
  set exposuresperdither 2
  set filters {BR}
  
  executor::setsecondaryoffset 0
  executor::track

  executor::setreadmode 1MHz
  executor::setwindow "default"
  executor::setbinning 2

  executor::waituntiltracking

  foreach {eastoffset northoffset} {
      0as   0as
    +60as +60as
    +60as -60as
    -60as -60as
    -60as +60as
      0as -60as
    +60as   0as
      0as +60as
    -60as   0as
  } {
    executor::offset $eastoffset $northoffset "default"
    executor::waituntiltracking
    foreach filter $filters {
      executor::movefilterwheel $filter
      set i 0
      while {$i < $exposuresperdither} {
        executor::expose object $exposuretime
        incr i
      }
    }
  }

  return true
}
